<!DOCTYPE html>

<head>
	<script type="text/javascript"
	src="http://cdn.craftycomponents.com/crafty-release.js"></script>
</head>
<body>

<script type="text/javascript">
Game = {
map_grid: {
    width:  13,
    height: 5,
	player_width: 6,
    tile: {
      width:  80,
      height: 80
    },
	contents: [[]],
  },
player1pos: 0,
player2pos: 0,

width: function() {
    return this.map_grid.width * this.map_grid.tile.width;
  },
 
  
  height: function() {
    return 	this.map_grid.height * this.map_grid.tile.height
			+ 2*this.map_grid.tile.height;
  },

  // Initialize and start our game
 start: function() {
    // Start crafty and set a background color so that we can see it's working
    Crafty.init(Game.width(), Game.height());
    Crafty.background('green');
 
    for (var x = 0; x < Game.map_grid.width; x++) {
	  Game.map_grid.contents.push(new Array());
      for (var y = 0; y < Game.map_grid.height; y++) {
		Game.map_grid.contents[x].push(0);
		
		//color everything in
        if (((x%2==0 && y%2==0) || x%2==1 && y%2==1) && x !=6) {
          Crafty.e('2D, Canvas, Color')
            .attr({
              x: x * Game.map_grid.tile.width,
              y: y * Game.map_grid.tile.height,
              w: Game.map_grid.tile.width,
              h: Game.map_grid.tile.height
            })
            .color('black');
        } else if(x!=6) {
          // divider
          Crafty.e('2D, Canvas, Color')
            .attr({
              x: x * Game.map_grid.tile.width,
              y: y * Game.map_grid.tile.height,
              w: Game.map_grid.tile.width,
              h: Game.map_grid.tile.height
            })
            .color('red');
        }
      }
    }
	Crafty.e("LeftMarker, 2D, DOM, Color")
		.color('rgb(0,255,255)')
		.attr({ x: Game.map_grid.tile.width / 3,
				y: Game.map_grid.tile.height / 3 + Game.map_grid.tile.height * 4,
				w: Game.map_grid.tile.width / 3,
				h: Game.map_grid.tile.height / 3 })
		.bind("KeyDown", function(e) {
			console.log(e.keyCode);
			if (e.keyCode == 37) {
				if (Game.player1pos > 0) {
					--Game.player1pos;
					this.x -= Game.map_grid.tile.width;
				}
			}
			else if (e.keyCode == 39) {
				if (Game.player1pos < Game.map_grid.player_width-1) {
					++Game.player1pos;
					this.x += Game.map_grid.tile.width;
				}
			}
				});
	Crafty.e("RightMarker, 2D, DOM, Color")
		.color('rgb(127, 0, 255)')
		.attr({ x: Game.map_grid.tile.width / 3 + Game.map_grid.tile.width * 7,
				y: Game.map_grid.tile.height / 3 + Game.map_grid.tile.height * 4,
				w: Game.map_grid.tile.width / 3,
				h: Game.map_grid.tile.height / 3 });
  }
};
window.addEventListener('load', Game.start);
</script>


  

</body>
</html>